<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>柒毓个人页面 - 柒毓's Portfolio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Page Sections */
        .page-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Settings Panel Styles */
        .settings-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            bottom: 20px; /* Stretch to bottom with margin */
            width: 600px; /* Increased width to fit all tabs */
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 0;
            z-index: 2001;
            transform: translateX(120%); /* Slide from right */
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            box-shadow: -10px 10px 40px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            opacity: 1; /* Reset opacity from previous change */
            visibility: visible; /* Reset visibility */
        }

        .settings-panel.show {
            transform: translateX(0);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .settings-content {
            padding: 1.5rem; /* Optimized padding */
            overflow-y: auto;
            flex: 1;
            /* Custom Scrollbar */
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        .settings-content::-webkit-scrollbar {
            width: 6px;
            display: block;
        }

        .settings-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
        }

        .settings-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        .settings-content::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        /* Settings Tabs */
        .settings-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            padding: 0.5rem;
            gap: 0.5rem;
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            flex-shrink: 0;
            /* Custom Scrollbar */
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        .settings-tabs::-webkit-scrollbar {
            height: 4px;
            display: block;
        }

        .settings-tabs::-webkit-scrollbar-track {
            background: transparent;
        }

        .settings-tabs::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
        }

        .settings-tab {
            padding: 0.6rem 0.8rem; /* More compact padding */
            border-radius: 20px;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.8rem; /* Slightly smaller font */
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }

        .settings-tab:hover {
            color: var(--text-main);
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--text-main);
        }

        .settings-tab.active {
            background: var(--text-main);
            color: black;
            border-color: var(--text-main);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .settings-section {
            display: none;
        }

        .settings-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .admin-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
            padding-right: 5px; /* Space for scrollbar */
            /* Custom Scrollbar */
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        .admin-list::-webkit-scrollbar {
            width: 4px;
            display: block;
        }
        
        .admin-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
        }

        .admin-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
        }

        .admin-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            border: 1px solid transparent;
        }

        .admin-item:hover {
            border-color: var(--border-color);
        }

        .admin-item-title {
            color: var(--text-main);
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
        }

        .btn-delete {
            background: #ff4444;
            color: white;
            border: none;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .btn-delete:hover {
            background: #cc0000;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .setting-item label {
            color: var(--text-secondary);
            flex: 1;
        }

        .setting-item input[type="color"] {
            border: none;
            width: 40px;
            height: 40px;
            cursor: pointer;
            background: none;
        }

        .setting-item input[type="file"] {
            color: var(--text-secondary);
            font-size: 0.8rem;
            width: 100%;
            margin-top: 0.5rem;
        }

        .admin-section {
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
        }
        
        .admin-section h4 {
            color: var(--text-main);
            margin-bottom: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: white;
            margin-bottom: 1rem;
            font-size: 0.95rem;
            transition: border-color 0.2s;
        }

        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            outline: none;
            border-color: var(--text-main);
            background: rgba(255, 255, 255, 0.12);
        }

        .btn-upload {
            background: var(--text-main);
            color: black;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
        }

        :root {
            /* Black & White Starry Theme */
            --bg-color: #000000;
            --card-bg: rgba(20, 20, 20, 0.65);
            --text-main: #ffffff;
            --text-secondary: #a0a0a0;
            --accent-glow: rgba(255, 255, 255, 0.2);
            --border-color: rgba(255, 255, 255, 0.15);
            
            /* Monochrome Accents */
            --accent-white: #ffffff;
            --accent-gray: #888888;
            --accent-silver: #c0c0c0;
            
            /* Shadows for depth in dark mode */
            --shadow-soft: 0 10px 30px rgba(0, 0, 0, 0.8);
            --shadow-card: 0 4px 6px rgba(0, 0, 0, 0.5), 0 10px 15px rgba(0, 0, 0, 0.3);
            
            --radius-lg: 24px;
            --radius-md: 16px;
            --radius-pill: 50px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 100px;
            overflow-x: hidden;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            transition: background 0.5s ease;
        }

        /* Canvas Particle System */
        #particleCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            /* Make it transparent so background image is clear */
            background: transparent;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(16px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 800;
            font-size: 1.2rem;
            color: var(--text-main);
            text-decoration: none;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        .brand-logo {
            width: 32px;
            height: 32px;
            background: var(--text-main);
            color: black;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 900;
        }

        .nav-items {
            display: flex;
            gap: 0.5rem;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 600;
            padding: 0.5rem 1.2rem;
            border-radius: var(--radius-pill);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.95rem;
            border: 1px solid transparent;
        }

        .nav-link:hover {
            color: var(--text-main);
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .nav-link.active {
            background: var(--text-main);
            color: black;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-main);
            border-color: var(--text-main);
        }

        .icon-btn.music-active {
            background: var(--text-main);
            color: black;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .user-avatar-sm {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--text-main);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        /* Layout */
        .container {
            max-width: 1400px;
            margin: 100px auto 0;
            padding: 0 1.5rem;
            display: grid;
            grid-template-columns: 350px 1fr; /* 350px Sidebar + Rest */
            gap: 2rem;
            align-items: start;
        }

        /* Left Sidebar Styles */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            position: sticky;
            top: 90px;
            height: calc(100vh - 120px);
            overflow-y: auto;
            scrollbar-width: none; /* Hide scrollbar Firefox */
        }
        
        .sidebar::-webkit-scrollbar {
            display: none; /* Hide scrollbar Chrome/Safari */
        }

        .profile-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 2rem 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            position: relative;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin-bottom: 1rem;
            border: 4px solid var(--text-main);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            object-fit: cover;
        }

        .profile-name {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-main);
            margin-bottom: 0.5rem;
            font-family: 'Orbitron', sans-serif;
        }

        .profile-badge {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-main);
            padding: 0.3rem 1rem;
            border-radius: var(--radius-pill);
            font-size: 0.8rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .profile-bio {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .social-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            justify-content: center;
        }

        .social-btn {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-main);
            font-size: 1.1rem;
            text-decoration: none;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
        }

        .social-btn:hover {
            transform: translateY(-3px);
            background: var(--text-main);
            color: black;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        .skills-section {
            width: 100%;
            text-align: left;
            margin-bottom: 2rem;
        }

        .skills-title, .tools-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            margin-bottom: 0.8rem;
            font-weight: 700;
        }

        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .skill-chip {
            background: transparent;
            color: var(--text-main);
            padding: 0.3rem 0.8rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s;
        }
        
        .skill-chip:hover {
            background: var(--text-main);
            color: black;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        /* Tools Section */
        .tools-section {
            width: 100%;
            text-align: left;
            margin-bottom: 5rem; /* Space for music player */
        }

        .tools-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .tool-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s;
        }

        .tool-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .tool-icon {
            font-size: 1.2rem;
            color: var(--text-main);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .tool-details h4 {
            font-size: 0.9rem;
            color: var(--text-main);
            margin-bottom: 0.2rem;
        }

        .tool-details p {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Fixed Music Player in Sidebar */
        .music-player-fixed {
            position: absolute;
            bottom: 1.5rem;
            left: 1.5rem;
            right: 1.5rem;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }

        .player-info-mini {
            display: flex;
            flex-direction: column;
        }

        .player-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-main);
        }

        .player-status {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .player-btn-mini {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--text-main);
            color: black;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .player-btn-mini:hover {
            transform: scale(1.1);
        }

        /* Right Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        /* Hero Card */
        .hero-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 3rem;
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        /* Feature Card (New Style) */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-top: 2rem;
        }

        .feature-card {
            position: relative;
            height: 220px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            text-decoration: none;
            box-shadow: var(--shadow-card);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.2);
            border-color: var(--text-main);
        }

        .feature-card-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            transition: transform 0.5s ease;
        }

        .feature-card:hover .feature-card-bg {
            transform: scale(1.05);
        }

        .feature-card-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.2) 60%, rgba(0,0,0,0) 100%);
        }

        .feature-card-content {
            position: absolute;
            bottom: 1.5rem;
            left: 1.5rem;
            z-index: 2;
        }

        .feature-card h3 {
            color: white;
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 0.3rem;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
        }

        .feature-card span {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85rem;
            font-weight: 600;
        }

        @media (max-width: 900px) {
            .feature-grid {
                grid-template-columns: 1fr;
            }
            .feature-card {
                height: 180px;
            }
        }

        .hero-greeting {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--text-main);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Orbitron', sans-serif;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .hero-text {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin-bottom: 2rem;
            line-height: 1.8;
        }

        .hero-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.8rem 1.8rem;
            border-radius: var(--radius-pill);
            font-weight: 700;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--text-main);
            color: black;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.6);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-main);
            border: 1px solid var(--text-main);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Section Header */
        .section-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 1rem;
        }

        .section-tag {
            width: 4px;
            height: 24px;
            background: var(--text-main);
            border-radius: 4px;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.6);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-main);
            letter-spacing: 1px;
            font-family: 'Orbitron', sans-serif;
        }

        /* Projects Grid */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .project-card {
            background: var(--card-bg);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            height: auto; /* Allow flexible height but constrained by grid */
            min-height: 240px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align to top */
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-card);
            text-decoration: none;
            color: inherit;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(5px);
        }

        .project-card:hover {
            transform: translateY(-5px);
            border-color: var(--text-main);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.15);
        }

        .project-icon-wrapper {
            width: 50px; /* Slightly smaller */
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
        }

        .project-info h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            color: var(--text-main);
            line-height: 1.4;
        }

        .project-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
            
            /* Line Clamping for Description */
            display: -webkit-box;
            -webkit-line-clamp: 3; /* Limit to 3 lines */
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 1rem;
        }

        .category-pill {
            display: inline-block;
            padding: 0.25rem 0.8rem;
            border-radius: var(--radius-pill);
            font-size: 0.75rem;
            font-weight: 700;
            color: black;
            margin-top: auto; /* Push to bottom if flex space allows */
            align-self: flex-start;
            background: var(--text-main);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .media-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }

        /* Contact Card Styles */
        .contact-section {
            margin-top: 3rem;
            margin-bottom: 2rem;
        }

        .contact-card {
            background: rgba(20, 20, 20, 0.6);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-lg);
            padding: 2.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            gap: 2rem;
            position: relative;
            overflow: hidden;
        }

        .contact-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            position: relative;
            z-index: 2;
        }

        .contact-title-group {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .contact-pill-icon {
            width: 6px;
            height: 24px;
            background: var(--text-main);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .contact-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-main);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        .contact-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .contact-content {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 3rem;
            position: relative;
            z-index: 2;
        }

        /* QR Grid */
        .qr-grid {
            display: flex;
            gap: 1.5rem;
            justify-content: flex-start;
        }

        .qr-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.8rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s;
        }

        .qr-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--text-main);
        }

        .qr-img {
            width: 100px;
            height: 100px;
            object-fit: contain;
            background: white; /* QR needs contrast */
            padding: 5px;
            border-radius: 8px;
        }

        .qr-label {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-main);
        }

        /* Info Pills */
        .info-stack {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            justify-content: center;
        }

        .info-pill-row {
            display: flex;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            transition: all 0.3s;
        }

        .info-pill-row:hover {
            border-color: var(--text-main);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }

        .info-label {
            background: rgba(255, 255, 255, 0.1);
            color: #a0a0a0;
            padding: 0.8rem 1.5rem;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
        }

        .info-value {
            padding: 0.8rem 1.5rem;
            color: white;
            font-weight: 700;
            font-size: 0.95rem;
            flex: 1;
            display: flex;
            align-items: center;
        }

        @media (max-width: 900px) {
            .contact-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            .qr-grid {
                justify-content: center;
                flex-wrap: wrap;
            }
            .contact-header {
                justify-content: center;
                text-align: center;
            }
            .feature-grid {
                grid-template-columns: 1fr;
            }
            .feature-card {
                height: 180px;
            }
            .container {
                grid-template-columns: 1fr;
                margin-top: 80px; /* Less top margin on mobile */
                padding: 0 1rem;
            }
            
            /* Stack the 3-column layout on mobile */
            #section-home > div:nth-child(2) {
                grid-template-columns: 1fr !important;
            }

            .sidebar {
                position: relative;
                top: 0;
                height: auto;
                overflow: visible;
                order: -1;
            }

            .profile-card {
                padding: 1.5rem 1rem;
            }
            
            .projects-grid {
                grid-template-columns: 1fr;
            }

            .music-player-fixed {
                position: fixed;
                bottom: 20px;
                left: 1rem;
                right: 1rem;
                z-index: 999;
                width: auto;
                background: rgba(0, 0, 0, 0.95);
            }

            /* Mobile Navigation */
            nav {
                padding: 0 1rem;
                height: 60px;
                flex-wrap: wrap;
            }

            .nav-left {
                width: 100%;
                justify-content: space-between;
                gap: 0;
            }

            .brand {
                font-size: 1rem;
            }

            .nav-items {
                position: fixed;
                top: 60px;
                left: 0;
                right: 0;
                background: rgba(0, 0, 0, 0.95);
                padding: 0.5rem 1rem;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
                border-bottom: 1px solid var(--border-color);
                gap: 0.5rem;
                display: flex;
                z-index: 1000;
            }

            .nav-items::-webkit-scrollbar {
                display: none;
            }

            .nav-link {
                padding: 0.4rem 0.8rem;
                font-size: 0.85rem;
                flex-shrink: 0;
            }

            .nav-right {
                position: absolute;
                top: 10px;
                right: 1rem;
            }

            /* Adjust Hero Text */
            .hero-greeting {
                font-size: 1.8rem;
            }

            .hero-text {
                font-size: 1rem;
            }

            /* Mobile Settings Panel */
            .settings-panel {
                width: 100%;
                right: 0;
                top: 0;
                bottom: 0;
                border-radius: 0;
                transform: translateX(100%);
            }
            
            /* Fix Content Overlap with Double Nav */
            .container {
                margin-top: 120px; /* 60px Nav + ~50px Menu Bar + gap */
            }
        }
    </style>
</head>
<body>

    <canvas id="particleCanvas"></canvas>
    <audio id="bgMusic" loop></audio>

    <!-- Navigation -->
    <nav>
        <div class="nav-left">
            <a href="#" class="brand">
                <div class="brand-logo">柒</div>
                柒毓个人页面
            </a>
            <div class="nav-items">
                <a href="#" class="nav-link active" data-target="home"><i class="fas fa-home"></i> 首页</a>
                <a href="#" class="nav-link" data-target="works"><i class="fas fa-layer-group"></i> 作品</a>
                <a href="#" class="nav-link" data-target="agents"><i class="fas fa-robot"></i> 智能体</a>
                <a href="#" class="nav-link" data-target="tools"><i class="fas fa-tools"></i> 工具</a>
                <a href="#" class="nav-link" data-target="articles"><i class="fas fa-pen-nib"></i> 文章</a>
            </div>
        </div>
        <div class="nav-right">
            <button class="icon-btn music-active" id="musicToggleBtn"><i class="fas fa-music"></i></button>
            <button class="icon-btn" id="settingsToggleBtn"><i class="fas fa-cog"></i></button>
            <img src="个人卡通图像.jpg" alt="Profile" class="user-avatar-sm">
        </div>
    </nav>

    <!-- Password Modal (Sidebar Style) -->
    <div id="passwordModal" class="settings-panel" style="z-index: 2002; height: auto; bottom: auto;">
        <div class="settings-header">
            <h3>Admin Access</h3>
            <button class="close-btn" id="closePasswordModal"><i class="fas fa-times"></i></button>
        </div>
        <div class="settings-content" style="padding: 2rem;">
            <div class="form-group">
                <input type="password" id="adminPasswordInput" placeholder="Enter Password" style="margin-bottom: 1.5rem;">
                <button class="btn-upload" onclick="verifyPassword()" style="width:100%; padding: 1rem;">Unlock Settings</button>
                <p id="passwordError" style="color:#ff4444; font-size:0.9rem; margin-top:1rem; display:none; text-align: center;">Incorrect Password</p>
            </div>
        </div>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h3>设置</h3>
            <button class="close-btn" id="closeSettingsBtn"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="settings-tabs">
            <div class="settings-tab" data-tab="general">通用</div>
            <div class="settings-tab" data-tab="projects">作品</div>
            <div class="settings-tab" data-tab="agents">智能体</div>
            <div class="settings-tab" data-tab="certificates">证书</div>
            <div class="settings-tab" data-tab="videos">我的视频</div>
            <div class="settings-tab" data-tab="workflow">我的工作流</div>
            <div class="settings-tab" data-tab="tools">工具</div>
            <div class="settings-tab" data-tab="articles">文章</div>
            <div class="settings-tab" data-tab="contact">联系信息</div>
            <div class="settings-tab" data-tab="deploy" style="color: #4ade80;">发布</div>
        </div>

        <div class="settings-content">
            <!-- General Settings -->
            <div class="settings-section active" id="tab-general">
                <div class="setting-item">
                    <label>背景颜色</label>
                    <input type="color" id="bgColorInput" value="#000000">
                </div>
                <div class="setting-item">
                    <label>背景图片</label>
                    <input type="file" id="bgImageInput" accept="image/*">
                </div>
                <div class="setting-item">
                    <label>背景音乐</label>
                    <input type="file" id="bgMusicInput" accept="audio/*">
                </div>
            </div>

            <!-- Projects Settings -->
            <div class="settings-section" id="tab-projects">
                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>添加应用 (作品)</h4>
                    <div class="form-group">
                        <input type="text" id="projTitle" placeholder="应用名称">
                        <input type="text" id="projDesc" placeholder="简短描述">
                        <input type="text" id="projLink" placeholder="链接地址">
                        <input type="text" id="projCategory" placeholder="分类 (e.g. Web App)">
                        <label style="color:var(--text-secondary); font-size:0.9rem; display:block; margin-bottom:0.5rem;">上传图标 (可选)</label>
                        <input type="file" id="projIconInput" accept="image/*">
                        <button class="btn-upload" onclick="uploadProject()">添加应用</button>
                    </div>
                </div>
                <div class="admin-section">
                    <h4>管理作品</h4>
                    <div id="adminProjectsList" class="admin-list"></div>
                </div>
            </div>

            <!-- Agents Settings -->
            <div class="settings-section" id="tab-agents">
                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>添加智能体</h4>
                    <div class="form-group">
                        <input type="text" id="agentTitle" placeholder="智能体名称">
                        <input type="text" id="agentDesc" placeholder="简短描述">
                        <input type="text" id="agentLink" placeholder="链接地址">
                        <label style="color:var(--text-secondary); font-size:0.9rem; display:block; margin-bottom:0.5rem;">上传图标 (可选)</label>
                        <input type="file" id="agentIconInput" accept="image/*">
                        <button class="btn-upload" onclick="addAgent()">添加智能体</button>
                    </div>
                </div>
                <div class="admin-section">
                    <h4>管理智能体</h4>
                    <div id="adminAgentsList" class="admin-list"></div>
                </div>
            </div>

            <!-- Certificates Settings -->
            <div class="settings-section" id="tab-certificates">
                <div class="admin-section" style="margin-top:0; border-top:none; background: rgba(255,255,255,0.03); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="margin-bottom: 0.5rem; color: #4ade80;">首页卡片配置</h4>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="color:var(--text-secondary); font-size:0.8rem;">跳转链接</label>
                        <input type="text" id="settingCertLink" placeholder="https://..." onchange="updateGlobalSetting('certLink', this.value)">
                        
                        <label style="color:var(--text-secondary); font-size:0.8rem; margin-top:0.5rem; display:block;">封面图片</label>
                        <input type="file" id="settingCertCover" accept="image/*" onchange="uploadCover('certCover', this)">
                    </div>
                </div>

                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>添加证书 (列表)</h4>
                    <div class="form-group">
                        <input type="text" id="certTitle" placeholder="证书名称">
                        <input type="text" id="certIssuer" placeholder="颁发机构">
                        <input type="text" id="certDate" placeholder="颁发日期">
                        <input type="text" id="certLink" placeholder="跳转链接 (可选)">
                        <label style="color:var(--text-secondary); font-size:0.9rem; display:block; margin-bottom:0.5rem;">上传证书图片 (可选)</label>
                        <input type="file" id="certImageInput" accept="image/*">
                        <button class="btn-upload" onclick="uploadCertificate()">添加证书</button>
                    </div>
                </div>
                <div class="admin-section">
                    <h4>管理证书</h4>
                    <div id="adminCertificatesList" class="admin-list"></div>
                </div>
            </div>

            <!-- Videos Settings -->
            <div class="settings-section" id="tab-videos">
                <div class="admin-section" style="margin-top:0; border-top:none; background: rgba(255,255,255,0.03); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="margin-bottom: 0.5rem; color: #4ade80;">首页卡片配置</h4>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="color:var(--text-secondary); font-size:0.8rem;">跳转链接</label>
                        <input type="text" id="settingVideoLink" placeholder="https://..." onchange="updateGlobalSetting('videoLink', this.value)">
                        
                        <label style="color:var(--text-secondary); font-size:0.8rem; margin-top:0.5rem; display:block;">封面图片</label>
                        <input type="file" id="settingVideoCover" accept="image/*" onchange="uploadCover('videoCover', this)">
                    </div>
                </div>

                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>上传视频</h4>
                    <div class="form-group">
                        <input type="text" id="videoTitle" placeholder="视频标题">
                        <input type="text" id="videoLink" placeholder="跳转链接 (可选)">
                        <label style="color:var(--text-secondary); font-size:0.9rem; display:block; margin-bottom:0.5rem;">上传视频文件 (MP4/WebM)</label>
                        <input type="file" id="videoFileInput" accept="video/*">
                        <button class="btn-upload" onclick="uploadVideo()">上传视频</button>
                    </div>
                </div>
                <div class="admin-section">
                    <h4>管理视频</h4>
                    <div id="adminVideosList" class="admin-list"></div>
                </div>
            </div>

            <!-- Workflow Settings -->
            <div class="settings-section" id="tab-workflow">
                <div class="admin-section" style="margin-top:0; border-top:none; background: rgba(255,255,255,0.03); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <h4 style="margin-bottom: 0.5rem; color: #4ade80;">首页卡片配置</h4>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="color:var(--text-secondary); font-size:0.8rem;">跳转链接</label>
                        <input type="text" id="settingWorkflowLink" placeholder="https://..." onchange="updateGlobalSetting('workflowLink', this.value)">
                        
                        <label style="color:var(--text-secondary); font-size:0.8rem; margin-top:0.5rem; display:block;">封面图片</label>
                        <input type="file" id="settingWorkflowCover" accept="image/*" onchange="uploadCover('workflowCover', this)">
                    </div>
                </div>

                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>上传工作流 (图片)</h4>
                    <div class="form-group">
                        <input type="text" id="workflowTitle" placeholder="工作流标题">
                        <input type="text" id="workflowLink" placeholder="跳转链接 (可选)">
                        <label style="color:var(--text-secondary); font-size:0.9rem; display:block; margin-bottom:0.5rem;">上传工作流图片</label>
                        <input type="file" id="workflowFileInput" accept="image/*">
                        <button class="btn-upload" onclick="uploadWorkflow()">上传工作流</button>
                    </div>
                </div>
                <div class="admin-section">
                    <h4>管理工作流</h4>
                    <div id="adminWorkflowList" class="admin-list"></div>
                </div>
            </div>

            <!-- Tools Settings -->
            <div class="settings-section" id="tab-tools">
                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>添加工具</h4>
                    <div class="form-group">
                        <input type="text" id="toolName" placeholder="工具名称 (e.g. VS Code)">
                        <input type="text" id="toolDesc" placeholder="描述">
                        <input type="text" id="toolLink" placeholder="工具链接 (可选)">
                        <label style="color:var(--text-secondary); font-size:0.9rem; display:block; margin-bottom:0.5rem;">上传图标 (可选)</label>
                        <input type="file" id="toolIconInput" accept="image/*">
                        <button class="btn-upload" onclick="addTool()">添加工具</button>
                    </div>
                </div>
                <div class="admin-section">
                    <h4>管理工具</h4>
                    <div id="adminToolsList" class="admin-list"></div>
                </div>
            </div>

            <!-- Articles Settings -->
            <div class="settings-section" id="tab-articles">
                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>发布文章</h4>
                    <div class="form-group">
                        <input type="text" id="articleTitle" placeholder="文章标题">
                        <textarea id="articleSummary" rows="3" placeholder="文章摘要..."></textarea>
                        <input type="text" id="articleLink" placeholder="文章链接 (可选)">
                        <input type="text" id="articleCategory" placeholder="分类 (e.g. Tech)">
                        <button class="btn-upload" onclick="addArticle()">发布文章</button>
                    </div>
                </div>
                <div class="admin-section">
                    <h4>管理文章</h4>
                    <div id="adminArticlesList" class="admin-list"></div>
                </div>
            </div>

            <!-- Contact Settings -->
            <div class="settings-section" id="tab-contact">
                <div class="admin-section" style="margin-top:0; border-top:none;">
                    <h4>联系信息配置</h4>
                    <div class="form-group">
                        <label style="color:var(--text-secondary); font-size:0.8rem;">邮箱地址</label>
                        <input type="text" id="settingEmail" placeholder="e.g. email@example.com" onchange="updateGlobalSetting('contactEmail', this.value)">
                        
                        <label style="color:var(--text-secondary); font-size:0.8rem; margin-top:0.5rem; display:block;">全网 IP (Handle)</label>
                        <input type="text" id="settingHandle" placeholder="e.g. 毓见Agent" onchange="updateGlobalSetting('contactHandle', this.value)">
                    </div>

                    <h4 style="margin-top: 1.5rem;">社交账号二维码</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                        <!-- Douyin -->
                        <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; text-align: center;">
                            <label style="display:block; color:white; margin-bottom:0.5rem;">抖音</label>
                            <img id="previewQrDouyin" style="width:80px; height:80px; object-fit:contain; background:#333; margin-bottom:0.5rem; border-radius:4px;">
                            <input type="file" id="fileQrDouyin" accept="image/*" style="width:100%; font-size:0.7rem;" onchange="uploadCover('qrDouyin', this)">
                        </div>
                        
                        <!-- Xiaohongshu -->
                        <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; text-align: center;">
                            <label style="display:block; color:white; margin-bottom:0.5rem;">小红书</label>
                            <img id="previewQrRed" style="width:80px; height:80px; object-fit:contain; background:#333; margin-bottom:0.5rem; border-radius:4px;">
                            <input type="file" id="fileQrRed" accept="image/*" style="width:100%; font-size:0.7rem;" onchange="uploadCover('qrXiaohongshu', this)">
                        </div>

                        <!-- Video Account -->
                        <div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; text-align: center;">
                            <label style="display:block; color:white; margin-bottom:0.5rem;">视频号</label>
                            <img id="previewQrVideo" style="width:80px; height:80px; object-fit:contain; background:#333; margin-bottom:0.5rem; border-radius:4px;">
                            <input type="file" id="fileQrVideo" accept="image/*" style="width:100%; font-size:0.7rem;" onchange="uploadCover('qrVideoAccount', this)">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Deploy Settings -->
            <div class="settings-section" id="tab-deploy">
                <div class="admin-section" style="margin-top:0; border-top:none; text-align:center;">
                    <h4>同步发布到云端</h4>
                    <p style="color:var(--text-secondary); font-size:0.9rem; margin-bottom:1.5rem;">
                        <b>本地开发时：</b> 将本地的所有修改同步到 GitHub 仓库。<br>
                        <b>线上访问时：</b> 不需要点击此按钮。所有修改会自动保存并触发更新（约1-2分钟生效）。
                    </p>
                    <div id="sync-proxy-config" style="margin-bottom: 1rem; background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.85rem; color: var(--text-secondary);">
                            <i class="fas fa-network-wired"></i> Git 代理设置 (已自动检测)
                        </label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="gitProxyInput" value="127.0.0.1:10808" placeholder="例如: 127.0.0.1:10808" 
                                   style="flex: 1; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; padding: 5px 10px; color: white; font-size: 0.9rem;">
                            <button onclick="saveProxy()" style="background: rgba(255,255,255,0.1); border: none; padding: 5px 15px; border-radius: 4px; color: white; cursor: pointer; font-size: 0.85rem;">保存</button>
                        </div>
                        <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                            * 检测到系统代理端口为 10808，已自动为您填入。
                        </p>
                    </div>
                    <button class="btn-upload" onclick="deployToCloud()" id="deployBtn" style="background: #4ade80; color: black; font-size:1.1rem; padding:1rem;">
                        <i class="fas fa-cloud-upload-alt"></i> 立即同步发布
                    </button>
                    <div id="deployLog" style="margin-top:1.5rem; text-align:left; font-family:monospace; font-size:0.85rem; color:#a0a0a0; background:rgba(0,0,0,0.3); padding:1rem; border-radius:4px; display:none; white-space: pre-wrap;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="profile-card">
                <img src="个人卡通图像.jpg" alt="柒毓 Avatar" class="profile-avatar">
                <h2 class="profile-name">柒毓</h2>
                <span class="profile-badge">自动化玩家</span>
                
                <p class="profile-bio">
                    让更多人因AI更加强大<br>
                    n8n|扣子Agent|vibe coding
                </p>
                
                <div class="social-row">
                    <a href="#" class="social-btn"><i class="fab fa-github"></i></a>
                    <a href="#" class="social-btn"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-btn"><i class="fas fa-envelope"></i></a>
                </div>

                <div class="skills-section">
                    <div class="skills-title">SKILLSET</div>
                    <div class="skills-list">
                        <span class="skill-chip">Agent</span>
                        <span class="skill-chip">n8n</span>
                        <span class="skill-chip">RPA</span>
                        <span class="skill-chip">Python</span>
                        <span class="skill-chip">vibe coding</span>
                    </div>
                </div>

                <div class="tools-section">
                    <div class="tools-title">RECOMMENDED TOOLS</div>
                    <div class="tools-list">
                        <div class="tool-item">
                            <div class="tool-icon"><i class="fas fa-code"></i></div>
                            <div class="tool-details">
                                <h4>VS Code</h4>
                                <p>最强代码编辑器</p>
                            </div>
                        </div>
                        <div class="tool-item">
                            <div class="tool-icon"><i class="fab fa-figma"></i></div>
                            <div class="tool-details">
                                <h4>Figma</h4>
                                <p>UI 设计利器</p>
                            </div>
                        </div>
                        <div class="tool-item">
                            <div class="tool-icon"><i class="fas fa-robot"></i></div>
                            <div class="tool-details">
                                <h4>ChatGPT</h4>
                                <p>AI 生产力助手</p>
                            </div>
                        </div>
                        <div class="tool-item">
                            <div class="tool-icon"><i class="fab fa-chrome"></i></div>
                            <div class="tool-details">
                                <h4>Chrome</h4>
                                <p>Web 开发调试</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fixed Music Player inside Sidebar -->
                <div class="music-player-fixed">
                    <div class="player-info-mini">
                        <span class="player-title" id="playerTitle">No Music</span>
                        <span class="player-status" id="playerStatus">Paused</span>
                    </div>
                    <button class="player-btn-mini play-btn" id="sidebarPlayBtn"><i class="fas fa-play"></i></button>
                </div>
            </div>
        </aside>

        <!-- Right Content (Main) -->
        <main class="main-content">
            
            <!-- Home Section -->
            <div id="section-home" class="page-section active">
                <div class="hero-card">
                    <div class="hero-greeting">
                        你好，我是柒毓! <span style="font-size: 2rem;">👋</span>
                    </div>
                    <p class="hero-text">
                        欢迎来到我的星空风格个人主页。这里展示了我的设计作品、开发项目以及我喜欢的音乐和视频。
                    </p>
                    <div class="hero-actions">
                        <a href="#" class="btn btn-primary" onclick="document.querySelector('[data-target=works]').click()">浏览作品 →</a>
                        <a href="#" class="btn btn-secondary" onclick="document.getElementById('settingsToggleBtn').click()">个性化设置</a>
                    </div>
                </div>

                <!-- 三栏卡片布局 -->
                <div class="feature-grid">
                    <!-- 我的图片 (Renamed to Certificates as per user request mapping, but wait, user image said 'My Images', 'My Videos', 'My Certificates'. User prompt says: "My Certificates, My Videos, My Workflow". I will follow user prompt mapping.) -->
                    
                    <!-- Card 1: 我的证书 -->
                    <a href="#" id="feat-cert-link" class="feature-card" target="_blank">
                        <div class="feature-card-bg" id="feat-cert-bg"></div>
                        <div class="feature-card-overlay"></div>
                        <div class="feature-card-content">
                            <h3>我的证书</h3>
                            <span>点击查看</span>
                        </div>
                    </a>

                    <!-- Card 2: 我的视频 -->
                    <a href="#" id="feat-video-link" class="feature-card" target="_blank">
                        <div class="feature-card-bg" id="feat-video-bg"></div>
                        <div class="feature-card-overlay"></div>
                        <div class="feature-card-content">
                            <h3>我的视频</h3>
                            <span>点击查看</span>
                        </div>
                    </a>

                    <!-- Card 3: 我的工作流 -->
                    <a href="#" id="feat-workflow-link" class="feature-card" target="_blank">
                        <div class="feature-card-bg" id="feat-workflow-bg"></div>
                        <div class="feature-card-overlay"></div>
                        <div class="feature-card-content">
                            <h3>我的工作流</h3>
                            <span>点击查看</span>
                        </div>
                    </a>
                </div>
                <!-- Contact / Social Section -->
                <div class="contact-section">
                    <div class="contact-card">
                        <div class="contact-header">
                            <div class="contact-title-group">
                                <div class="contact-pill-icon"></div>
                                <h2 class="contact-title">联系我</h2>
                            </div>
                            <div class="contact-subtitle">
                                扫码关注我的社交账号，获取最新动态 <span style="color:#ffd700;">✨</span>
                            </div>
                        </div>

                        <div class="contact-content">
                            <!-- Left: QR Codes -->
                            <div class="qr-grid">
                                <div class="qr-item">
                                    <img src="" id="displayQrDouyin" class="qr-img" alt="抖音">
                                    <span class="qr-label">抖音</span>
                                </div>
                                <div class="qr-item">
                                    <img src="" id="displayQrRed" class="qr-img" alt="小红书">
                                    <span class="qr-label">小红书</span>
                                </div>
                                <div class="qr-item">
                                    <img src="" id="displayQrVideo" class="qr-img" alt="视频号">
                                    <span class="qr-label">视频号</span>
                                </div>
                            </div>

                            <!-- Right: Info Pills -->
                            <div class="info-stack">
                                <div class="info-pill-row">
                                    <div class="info-label">抖&emsp;音</div>
                                    <div class="info-value display-handle">毓见Agent</div>
                                </div>
                                <div class="info-pill-row">
                                    <div class="info-label">小红书</div>
                                    <div class="info-value display-handle">毓见Agent</div>
                                </div>
                                <div class="info-pill-row">
                                    <div class="info-label">视频号</div>
                                    <div class="info-value display-handle">毓见Agent</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Works Section -->
            <div id="section-works" class="page-section">
                <div class="section-header">
                    <div class="section-tag"></div>
                    <h2 class="section-title">全部作品</h2>
                </div>
                <div class="projects-grid" id="worksGrid">
                    <!-- Loaded dynamically -->
                </div>
            </div>

            <!-- Agents Section -->
            <div id="section-agents" class="page-section">
                <div class="section-header">
                    <div class="section-tag"></div>
                    <h2 class="section-title">智能体</h2>
                </div>
                <div class="projects-grid" id="agentsGrid">
                    <!-- Loaded dynamically -->
                </div>
            </div>

            <!-- Tools Section (Static for now, can be dynamic too) -->
            <div id="section-tools" class="page-section">
                <div class="section-header">
                    <div class="section-tag"></div>
                    <h2 class="section-title">常用工具清单</h2>
                </div>
                <div class="hero-card" style="margin-bottom: 2rem;">
                    <div style="text-align: center;">
                        <div style="width: 60px; height: 60px; background: #333; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                            <i class="fas fa-wrench" style="color: #fff; font-size: 1.5rem;"></i>
                        </div>
                        <h3 style="color: var(--text-main); margin-bottom: 0.5rem;">常用工具清单</h3>
                        <p style="color: var(--text-secondary);">这里列出了我日常开发和设计使用的高效工具。</p>
                    </div>
                </div>
                <div class="projects-grid">
                    <div class="project-card">
                        <div class="project-icon-wrapper"><i class="fas fa-code"></i></div>
                        <h3>VS Code</h3>
                        <p>最强代码编辑器</p>
                        <span class="category-pill">Dev</span>
                    </div>
                    <div class="project-card">
                        <div class="project-icon-wrapper"><i class="fab fa-figma"></i></div>
                        <h3>Figma</h3>
                        <p>UI 设计利器</p>
                        <span class="category-pill">Design</span>
                    </div>
                </div>
            </div>

            <!-- Articles Section -->
            <div id="section-articles" class="page-section">
                <div class="section-header">
                    <div class="section-tag"></div>
                    <h2 class="section-title">最新文章</h2>
                </div>
                <div class="projects-grid">
                    <div class="project-card">
                        <div class="project-icon-wrapper">📝</div>
                        <h3>Hello World</h3>
                        <p>这是我的第一篇博客文章...</p>
                        <span class="category-pill">Blog</span>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // Use relative path for production (Vercel) compatibility
        const API_URL = '/api';
        
        // Global Settings State to prevent partial updates from resetting other fields
        let globalSettings = {};

        // --- Data Fetching ---
        async function fetchData() {
            try {
                const res = await fetch(`${API_URL}/data`);
                const data = await res.json();
                
                applySettings(data.settings);
                renderProjects(data.projects);
                renderAgents(data.agents);
                renderCertificates(data.certificates);
                renderMedia(data.media);
                renderTools(data.tools);
                renderArticles(data.articles);

                // Render Admin Lists
                renderAdminList('adminProjectsList', data.projects, 'projects');
                renderAdminList('adminAgentsList', data.agents, 'agents');
                renderAdminList('adminCertificatesList', data.certificates, 'certificates');
                
                // Split Media into Videos and Workflow for Admin List
                const videos = (data.media || []).filter(m => m.type === 'video');
                const workflows = (data.media || []).filter(m => m.type === 'image');
                
                renderAdminList('adminVideosList', videos, 'media');
                renderAdminList('adminWorkflowList', workflows, 'media');

                renderAdminList('adminToolsList', data.tools, 'tools');
                renderAdminList('adminArticlesList', data.articles, 'articles');
            } catch (err) {
                console.error('Failed to fetch data:', err);
            }
        }

        // --- New Feature Card Logic ---

        async function updateGlobalSetting(key, value) {
            await fetch(`${API_URL}/settings`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ [key]: value })
            });
            // Update UI immediately
            applySettings({ [key]: value });
        }

        async function uploadCover(type, input) {
            const file = input.files[0];
            if (!file) return;

            const formData = new FormData();
            formData.append('file', file);
            
            // Show loading
            const originalLabel = input.previousElementSibling.textContent;
            input.previousElementSibling.textContent = '正在上传...';
            input.disabled = true;

            try {
                const res = await fetch(`${API_URL}/upload/${type}`, { method: 'POST', body: formData });
                const data = await res.json();
                
                // Update UI
                const settingKey = type; // e.g., 'certCover'
                applySettings({ [settingKey]: data.url });
                alert('封面更新成功！');
            } catch (e) {
                console.error(e);
                alert('上传失败');
            } finally {
                input.previousElementSibling.textContent = originalLabel;
                input.disabled = false;
                input.value = ''; // Clear input
            }
        }

        function renderAdminList(elementId, items, type) {
            const container = document.getElementById(elementId);
            if (!container) return;

            if (!items || items.length === 0) {
                container.innerHTML = '<p style="color:var(--text-secondary); font-size:0.8rem;">No items yet.</p>';
                return;
            }

            container.innerHTML = items.map(item => `
                <div class="admin-item">
                    <span class="admin-item-title">${item.title || item.name}</span>
                    <button class="btn-delete" onclick="deleteItem('${type}', ${item.id})">Delete</button>
                </div>
            `).join('');
        }

        async function deleteItem(type, id) {
            if (!confirm('Are you sure you want to delete this item?')) return;
            
            try {
                await fetch(`${API_URL}/${type}/${id}`, { method: 'DELETE' });
                fetchData(); // Refresh all lists
            } catch (err) {
                console.error('Failed to delete:', err);
                alert('Failed to delete item.');
            }
        }

        function applySettings(newSettings) {
            // Merge new settings into global state
            globalSettings = { ...globalSettings, ...newSettings };
            const settings = globalSettings;

            if (settings.backgroundColor) {
                document.documentElement.style.setProperty('--bg-color', settings.backgroundColor);
                const bgInput = document.getElementById('bgColorInput');
                if(bgInput) bgInput.value = settings.backgroundColor;
            }
            if (settings.backgroundImage) {
                document.body.style.backgroundImage = `url(${settings.backgroundImage})`;
            }
            if (settings.backgroundMusic) {
                const audio = document.getElementById('bgMusic');
                const currentSrc = audio.src;
                const newSrc = settings.backgroundMusic;
                if (currentSrc !== newSrc && !currentSrc.endsWith(newSrc)) {
                    audio.src = newSrc;
                    document.getElementById('playerTitle').textContent = "背景音乐";
                }
            }
            
            // --- Feature Cards Settings ---
            
            // Certificates
            document.getElementById('feat-cert-link').href = settings.certLink || '#';
            const inputCert = document.getElementById('settingCertLink');
            if (inputCert && document.activeElement !== inputCert) inputCert.value = settings.certLink || '';

            if (settings.certCover) {
                document.getElementById('feat-cert-bg').style.backgroundImage = `url(${settings.certCover})`;
            } else {
                 // Default fallback gradient if no image
                document.getElementById('feat-cert-bg').style.background = 'linear-gradient(45deg, #1a1a1a, #2d2d2d)';
            }

            // Videos
            document.getElementById('feat-video-link').href = settings.videoLink || '#';
            const inputVideo = document.getElementById('settingVideoLink');
            if (inputVideo && document.activeElement !== inputVideo) inputVideo.value = settings.videoLink || '';

            if (settings.videoCover) {
                document.getElementById('feat-video-bg').style.backgroundImage = `url(${settings.videoCover})`;
            } else {
                document.getElementById('feat-video-bg').style.background = 'linear-gradient(45deg, #1a1a1a, #2d2d2d)';
            }

            // Workflow
            document.getElementById('feat-workflow-link').href = settings.workflowLink || '#';
            const inputWorkflow = document.getElementById('settingWorkflowLink');
            if (inputWorkflow && document.activeElement !== inputWorkflow) inputWorkflow.value = settings.workflowLink || '';

            if (settings.workflowCover) {
                document.getElementById('feat-workflow-bg').style.backgroundImage = `url(${settings.workflowCover})`;
            } else {
                document.getElementById('feat-workflow-bg').style.background = 'linear-gradient(45deg, #1a1a1a, #2d2d2d)';
            }

            // --- Contact Settings ---
            if (settings.contactEmail) {
                const emailEl = document.getElementById('displayEmail');
                if (emailEl) emailEl.textContent = settings.contactEmail;
                const input = document.getElementById('settingEmail');
                if(input && document.activeElement !== input) input.value = settings.contactEmail;
            }
            if (settings.contactHandle) {
                // Update all handle displays
                document.querySelectorAll('.display-handle').forEach(el => {
                    el.textContent = settings.contactHandle;
                });
                // Fallback for ID if it still exists elsewhere
                const handleEl = document.getElementById('displayHandle');
                if (handleEl) handleEl.textContent = settings.contactHandle;

                const input = document.getElementById('settingHandle');
                if(input && document.activeElement !== input) input.value = settings.contactHandle;
            }

            // QRs
            const setQr = (key, displayId, previewId, fallbackText) => {
                const el = document.getElementById(displayId);
                const prev = document.getElementById(previewId);
                if (settings[key]) {
                    if(el) el.src = settings[key];
                    if(prev) prev.src = settings[key];
                } else {
                    // Fallback placeholder
                    const placeholder = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${fallbackText}`;
                    if(el) el.src = placeholder;
                    if(prev) prev.src = placeholder;
                }
            };

            setQr('qrDouyin', 'displayQrDouyin', 'previewQrDouyin', 'Douyin');
            setQr('qrXiaohongshu', 'displayQrRed', 'previewQrRed', 'Xiaohongshu');
            setQr('qrVideoAccount', 'displayQrVideo', 'previewQrVideo', 'WeChatVideo');
        }

        function renderProjects(projects) {
            const html = (projects || []).map(p => `
                <a href="${p.link || '#'}" class="project-card" target="_blank">
                    <div class="project-icon-wrapper">
                         ${p.iconUrl ? `<img src="${p.iconUrl}" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">` : '<i class="fas fa-layer-group"></i>'}
                    </div>
                    <div class="project-info">
                        <h3>${p.title}</h3>
                        <p>${p.description}</p>
                    </div>
                    <span class="category-pill">${p.category}</span>
                </a>
            `).join('');
            
            const worksGrid = document.getElementById('worksGrid');
            if(worksGrid) worksGrid.innerHTML = html || '<p style="color:#888;">暂无作品</p>';
        }

        function renderAgents(agents) {
            const html = (agents || []).map(a => `
                <a href="${a.link || '#'}" class="project-card" target="_blank">
                    <div class="project-icon-wrapper">
                         ${a.iconUrl ? `<img src="${a.iconUrl}" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">` : '<i class="fas fa-robot"></i>'}
                    </div>
                    <div class="project-info">
                        <h3>${a.title}</h3>
                        <p>${a.description}</p>
                    </div>
                    <span class="category-pill">Agent</span>
                </a>
            `).join('');
            
            const agentsGrid = document.getElementById('agentsGrid');
            if(agentsGrid) agentsGrid.innerHTML = html || '<p style="color:#888;">暂无智能体</p>';
        }

        function renderMedia(mediaList) {
            const videos = (mediaList || []).filter(m => m.type === 'video');
            const products = (mediaList || []).filter(m => m.type === 'image');

            const videosGrid = document.getElementById('videosGrid');
            if (videosGrid) {
                videosGrid.innerHTML = videos.map(v => `
                    <a href="${v.link || v.url}" class="project-card" target="_blank" style="text-decoration: none;">
                        <div style="position: relative; width: 100%; margin-bottom: 1rem;">
                            <video src="${v.url}" style="width:100%; border-radius:var(--radius-md); display: block;" muted loop onmouseover="this.play()" onmouseout="this.pause()"></video>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none;">
                                <i class="fas fa-play-circle" style="font-size: 3rem; color: rgba(255,255,255,0.8);"></i>
                            </div>
                        </div>
                        <h3>${v.title}</h3>
                        <span class="category-pill">Video</span>
                    </a>
                `).join('') || '<p style="color:#888; text-align:center;">暂无视频</p>';
            }

            const productsGrid = document.getElementById('productsGrid');
            if (productsGrid) {
                productsGrid.innerHTML = products.map(product => `
                    <a href="${product.link || product.url}" class="project-card" target="_blank" style="text-decoration: none;">
                        <img src="${product.url}" class="media-preview" style="border-radius:var(--radius-md); margin-bottom:1rem;">
                        <h3>${product.title}</h3>
                        <span class="category-pill">Workflow</span>
                    </a>
                `).join('') || '<p style="color:#888; text-align:center;">暂无我的工作流</p>';
            }
        }

        function renderCertificates(certificates) {
            const html = (certificates || []).map(c => `
                <a href="${c.link || c.imageUrl || '#'}" class="project-card" target="_blank" style="text-decoration: none;">
                    <div class="project-icon-wrapper">
                        ${c.imageUrl ? `<img src="${c.imageUrl}" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">` : '<i class="fas fa-certificate"></i>'}
                    </div>
                    <h3>${c.title}</h3>
                    <p>${c.issuer}</p>
                    <p style="font-size:0.8rem; color:var(--text-secondary);">${c.date}</p>
                    <span class="category-pill">Certificate</span>
                </a>
            `).join('');
            
            const certificatesGrid = document.getElementById('certificatesGrid');
            if(certificatesGrid) certificatesGrid.innerHTML = html || '<p style="color:#888;">暂无证书</p>';
        }

        function renderTools(tools) {
            // Render grid cards for the Tools Section in main content.
            const gridHtml = (tools || []).map(t => `
                <div class="project-card" ${t.link ? `onclick="window.open('${t.link}', '_blank')" style="cursor:pointer;"` : ''}>
                    <div class="project-icon-wrapper">
                        ${t.iconUrl ? `<img src="${t.iconUrl}" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">` : `<i class="${t.icon || 'fas fa-wrench'}"></i>`}
                    </div>
                    <h3>${t.name}</h3>
                    <p>${t.description}</p>
                    <span class="category-pill">Tool</span>
                </div>
            `).join('');
            
            // If we want to replace the static content in #section-tools .projects-grid
            const toolsGrid = document.querySelector('#section-tools .projects-grid');
            if(toolsGrid) toolsGrid.innerHTML = gridHtml || '<p style="color:#888;">暂无工具</p>';
        }

        function renderArticles(articles) {
            const html = (articles || []).map(a => `
                <div class="project-card" onclick="window.open('${a.link || '#'}', '_blank')">
                    <div class="project-icon-wrapper">📝</div>
                    <h3>${a.title}</h3>
                    <p>${a.summary}</p>
                    <span class="category-pill">${a.category || 'Blog'}</span>
                </div>
            `).join('');
            
            const articlesGrid = document.querySelector('#section-articles .projects-grid');
            if(articlesGrid) articlesGrid.innerHTML = html || '<p style="color:#888;">暂无文章</p>';
        }

        // --- Admin Actions ---
        
        // Change Background Color
        document.getElementById('bgColorInput').addEventListener('change', async (e) => {
            const color = e.target.value;
            applySettings({ backgroundColor: color });
            
            await fetch(`${API_URL}/settings`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ backgroundColor: color })
            });
        });

        // Upload Background Image
        document.getElementById('bgImageInput').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            // Check file size (allow up to 20MB for high quality images)
            if (file.size > 20 * 1024 * 1024) {
                alert('文件过大！请上传小于 20MB 的图片文件。');
                e.target.value = ''; // Clear input
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            // Show loading state
            const label = e.target.previousElementSibling;
            const originalText = label.textContent;
            label.textContent = '背景图片 (正在上传...)';
            
            try {
                const res = await fetch(`${API_URL}/upload/background`, { method: 'POST', body: formData });
                const data = await res.json();
                applySettings({ backgroundImage: data.url });
                alert('背景图片上传成功！');
            } catch (error) {
                alert('背景图片上传失败，请重试。');
                console.error('Background image upload failed:', error);
            } finally {
                // Restore original label text
                label.textContent = originalText;
            }
        });

        // Upload Music
        document.getElementById('bgMusicInput').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            // Check file size (limit to 4MB for Vercel/GitHub compatibility)
            if (file.size > 4 * 1024 * 1024) {
                alert('文件过大！请上传小于 4MB 的音频文件。');
                e.target.value = ''; // Clear input
                return;
            }

            // Show loading state
            const label = e.target.previousElementSibling;
            const originalText = label.textContent;
            label.textContent = '背景音乐 (正在上传...)';
            e.target.disabled = true;

            const formData = new FormData();
            formData.append('file', file);
            
            try {
                const res = await fetch(`${API_URL}/upload/music`, { method: 'POST', body: formData });
                if (!res.ok) throw new Error('Upload failed');
                
                const data = await res.json();
                applySettings({ backgroundMusic: data.url });
                
                const audio = document.getElementById('bgMusic');
                // audio.src is updated by applySettings
                document.getElementById('playerTitle').textContent = file.name.replace(/\.[^/.]+$/, ""); // Remove extension
                
                // Try to auto-play
                try {
                    await audio.play();
                    document.getElementById('playerStatus').textContent = "Playing...";
                    document.getElementById('sidebarPlayBtn').innerHTML = '<i class="fas fa-pause"></i>';
                    document.getElementById('musicToggleBtn').classList.add('music-active');
                } catch (err) {
                    console.log("Auto-play blocked, user interaction required");
                }

                alert('背景音乐上传成功！');
            } catch (err) {
                console.error(err);
                alert('上传失败，请重试。');
            } finally {
                // Reset UI
                label.textContent = originalText;
                e.target.disabled = false;
            }
        });

        // Upload Project
        async function uploadProject() {
            const formData = new FormData();
            formData.append('title', document.getElementById('projTitle').value);
            formData.append('description', document.getElementById('projDesc').value);
            formData.append('link', document.getElementById('projLink').value);
            formData.append('category', document.getElementById('projCategory').value);
            
            const iconFile = document.getElementById('projIconInput').files[0];
            if (iconFile) {
                formData.append('icon', iconFile);
            }
            
            try {
                const res = await fetch(`${API_URL}/projects`, {
                    method: 'POST',
                    body: formData
                });
                if (!res.ok) throw new Error('Failed to upload project');
                alert('应用添加成功！刷新页面查看。');
                fetchData();
            } catch (e) {
                console.error(e);
                alert('添加失败，请重试。');
            }
        }

        // Add Agent
        async function addAgent() {
            const formData = new FormData();
            formData.append('title', document.getElementById('agentTitle').value);
            formData.append('description', document.getElementById('agentDesc').value);
            formData.append('link', document.getElementById('agentLink').value);
            
            const iconFile = document.getElementById('agentIconInput').files[0];
            if (iconFile) {
                formData.append('icon', iconFile);
            }
            
            try {
                const res = await fetch(`${API_URL}/agents`, {
                    method: 'POST',
                    body: formData
                });
                if (!res.ok) throw new Error('Failed to add agent');
                alert('智能体添加成功！');
                fetchData();
            } catch (e) {
                console.error(e);
                alert('添加失败，请重试。');
            }
        }

        // Upload Video
        async function uploadVideo() {
            const fileInput = document.getElementById('videoFileInput');
            const file = fileInput.files[0];
            if (!file) return alert('请选择视频文件');

            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', 'video');
            formData.append('title', document.getElementById('videoTitle').value);
            formData.append('link', document.getElementById('videoLink').value);

            try {
                const res = await fetch(`${API_URL}/upload/media`, { method: 'POST', body: formData });
                if (!res.ok) throw new Error('Upload failed');
                alert('视频上传成功！刷新页面查看。');
                fetchData();
            } catch (e) {
                console.error(e);
                alert('上传失败，请重试。');
            }
        }

        // Upload Workflow
        async function uploadWorkflow() {
            const fileInput = document.getElementById('workflowFileInput');
            const file = fileInput.files[0];
            if (!file) return alert('请选择图片文件');

            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', 'image');
            formData.append('title', document.getElementById('workflowTitle').value);
            formData.append('link', document.getElementById('workflowLink').value);

            try {
                const res = await fetch(`${API_URL}/upload/media`, { method: 'POST', body: formData });
                if (!res.ok) throw new Error('Upload failed');
                alert('工作流上传成功！刷新页面查看。');
                fetchData();
            } catch (e) {
                console.error(e);
                alert('上传失败，请重试。');
            }
        }

        // Add Tool
        async function addTool() {
            const formData = new FormData();
            formData.append('name', document.getElementById('toolName').value);
            formData.append('description', document.getElementById('toolDesc').value);
            formData.append('link', document.getElementById('toolLink').value);
            
            const iconFile = document.getElementById('toolIconInput').files[0];
            if (iconFile) {
                formData.append('icon', iconFile);
            }
            
            try {
                const res = await fetch(`${API_URL}/tools`, {
                    method: 'POST',
                    body: formData
                });
                if (!res.ok) throw new Error('Failed to add tool');
                alert('工具添加成功！');
                fetchData();
            } catch (e) {
                console.error(e);
                alert('添加失败，请重试。');
            }
        }

        // Add Certificate
        async function uploadCertificate() {
            const formData = new FormData();
            formData.append('title', document.getElementById('certTitle').value);
            formData.append('issuer', document.getElementById('certIssuer').value);
            formData.append('date', document.getElementById('certDate').value);
            formData.append('link', document.getElementById('certLink').value);
            
            const imageFile = document.getElementById('certImageInput').files[0];
            if (imageFile) {
                formData.append('image', imageFile);
            }
            
            try {
                const res = await fetch(`${API_URL}/certificates`, {
                    method: 'POST',
                    body: formData
                });
                if (!res.ok) throw new Error('Failed to add certificate');
                alert('证书添加成功！');
                fetchData();
            } catch (e) {
                console.error(e);
                alert('添加失败，请重试。');
            }
        }

        // Add Article
        async function addArticle() {
            const article = {
                title: document.getElementById('articleTitle').value,
                summary: document.getElementById('articleSummary').value,
                link: document.getElementById('articleLink').value,
                category: document.getElementById('articleCategory').value
            };
            
            try {
                const res = await fetch(`${API_URL}/articles`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(article)
                });
                if (!res.ok) throw new Error('Failed to add article');
                alert('文章发布成功！');
                fetchData();
            } catch (e) {
                console.error(e);
                alert('发布失败，请重试。');
            }
        }

        // Deploy to Cloud
        function saveProxy() {
            const proxy = document.getElementById('gitProxyInput').value;
            localStorage.setItem('git_proxy', proxy);
            alert('代理设置已保存！同步时将尝试使用此代理。');
        }

        async function deployToCloud() {
            const btn = document.getElementById('deployBtn');
            const log = document.getElementById('deployLog');
            const proxy = localStorage.getItem('git_proxy');
            
            if (!confirm('确定要同步所有本地修改到云端并发布吗？')) return;

            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 正在同步发布中...';
            log.style.display = 'block';
            log.textContent = '> 开始同步进程...\n> 正在执行 Git Add/Commit/Push...';
            log.style.color = '#a0a0a0';

            try {
                const res = await fetch(`${API_URL}/deploy`, { 
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ proxy: proxy })
                });
                const data = await res.json();

                if (data.success) {
                    log.textContent += '\n> ' + data.message;
                    log.textContent += '\n> 成功！Vercel 正在自动构建上线。';
                    log.style.color = '#4ade80';
                    alert('发布成功！Vercel 正在后台更新，请稍候访问线上链接。');
                } else {
                    log.textContent += '\n> 错误: ' + data.error;
                    if (data.details) log.textContent += '\n' + data.details;
                    log.style.color = '#ff4444';
                }
            } catch (err) {
                log.textContent += '\n> 请求失败: ' + err.message;
                log.style.color = '#ff4444';
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-cloud-upload-alt"></i> 立即同步发布';
            }
        }

        // Initialize Proxy UI
        document.addEventListener('DOMContentLoaded', () => {
            const savedProxy = localStorage.getItem('git_proxy');
            if (savedProxy && document.getElementById('gitProxyInput')) {
                document.getElementById('gitProxyInput').value = savedProxy;
            }
        });


        // --- UI Interactions ---

        // Settings Panel Logic
        const settingsBtn = document.getElementById('settingsToggleBtn');
        const settingsPanel = document.getElementById('settingsPanel');
        const closeSettingsBtn = document.getElementById('closeSettingsBtn');
        const passwordModal = document.getElementById('passwordModal');
        const closePasswordModalBtn = document.getElementById('closePasswordModal');

        // Verify Password Logic
        async function verifyPassword() {
            const password = document.getElementById('adminPasswordInput').value;
            try {
                const res = await fetch(`${API_URL}/verify-password`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password })
                });
                const data = await res.json();
                
                if (data.success) {
                    passwordModal.classList.remove('show');
                    passwordModal.style.display = 'none';
                    // Use setTimeout to allow UI update
                    setTimeout(() => {
                        settingsPanel.style.display = 'flex'; // Ensure it's visible
                        // Force reflow
                        void settingsPanel.offsetWidth;
                        settingsPanel.classList.add('show');
                    }, 50);
                    
                    document.getElementById('adminPasswordInput').value = ''; // Clear password
                    document.getElementById('passwordError').style.display = 'none';
                } else {
                    document.getElementById('passwordError').style.display = 'block';
                }
            } catch (err) {
                console.error('Verify failed', err);
            }
        }

        // Open Password Modal instead of Settings Panel
        settingsBtn.addEventListener('click', () => {
            // Check if already open
            if (settingsPanel.classList.contains('show')) {
                settingsPanel.classList.remove('show');
                setTimeout(() => { settingsPanel.style.display = 'none'; }, 300); // Wait for transition
            } else {
                // Ensure settings panel is hidden
                settingsPanel.classList.remove('show');
                settingsPanel.style.display = 'none';
                
                // Show Password Modal
                passwordModal.style.display = 'flex';
                // Small timeout to allow display:block to apply before adding class (if we had transition)
                setTimeout(() => { passwordModal.classList.add('show'); }, 10);
            }
        });

        // Close Password Modal
        closePasswordModalBtn.addEventListener('click', () => {
            passwordModal.classList.remove('show');
            setTimeout(() => { passwordModal.style.display = 'none'; }, 300);
        });

        closeSettingsBtn.addEventListener('click', () => {
            settingsPanel.classList.remove('show');
            setTimeout(() => { settingsPanel.style.display = 'none'; }, 300);
        });

        // Settings Tabs Logic
        document.querySelectorAll('.settings-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs
                document.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Hide all sections
                document.querySelectorAll('.settings-section').forEach(s => s.classList.remove('active'));
                // Show target section
                const targetId = tab.getAttribute('data-tab');
                document.getElementById(`tab-${targetId}`).classList.add('active');
            });
        });

        // Tab Switching Logic
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                
                const targetId = link.getAttribute('data-target');
                document.querySelectorAll('.page-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                const targetSection = document.getElementById(`section-${targetId}`);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
            });
        });

        // Music Player Controls
        const bgMusic = document.getElementById('bgMusic');
        const sidebarPlayBtn = document.getElementById('sidebarPlayBtn');
        const topMusicBtn = document.getElementById('musicToggleBtn');
        const playerStatus = document.getElementById('playerStatus');

        function togglePlay() {
            if (bgMusic.paused) {
                bgMusic.play().catch(e => console.log("Audio play failed interaction required"));
                playerStatus.textContent = "Playing...";
                sidebarPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
                topMusicBtn.classList.add('music-active');
            } else {
                bgMusic.pause();
                playerStatus.textContent = "Paused";
                sidebarPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
                topMusicBtn.classList.remove('music-active');
            }
        }

        sidebarPlayBtn.addEventListener('click', togglePlay);
        topMusicBtn.addEventListener('click', togglePlay);

        // Handle initial audio load error gracefully
        bgMusic.addEventListener('error', (e) => {
            console.warn("Audio load error (expected if autoplay blocked):", e);
            playerStatus.textContent = "Click to Play";
            sidebarPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
            topMusicBtn.classList.remove('music-active');
        });


        // --- Starry Mouse Trail ---
        class StarryMouseTrail {
            constructor() {
                this.canvas = document.createElement('canvas');
                this.ctx = this.canvas.getContext('2d');
                this.canvas.style.position = 'fixed';
                this.canvas.style.top = '0';
                this.canvas.style.left = '0';
                this.canvas.style.width = '100%';
                this.canvas.style.height = '100%';
                this.canvas.style.pointerEvents = 'none';
                this.canvas.style.zIndex = '9999';
                document.body.appendChild(this.canvas);
                
                this.particles = [];
                this.colors = ['#FFFFFF', '#F0F8FF', '#E0FFFF', '#B0C4DE']; 
                this.resize();
                
                window.addEventListener('resize', () => this.resize());
                window.addEventListener('mousemove', (e) => this.spawn(e.clientX, e.clientY));
                
                this.animate();
            }
            
            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }
            
            spawn(x, y) {
                for(let i = 0; i < 3; i++) {
                    this.particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 2,
                        vy: (Math.random() - 0.5) * 2,
                        size: Math.random() * 3 + 1,
                        color: this.colors[Math.floor(Math.random() * this.colors.length)],
                        life: 1,
                        decay: 0.01 + Math.random() * 0.02,
                        rotation: Math.random() * Math.PI * 2,
                        rotationSpeed: (Math.random() - 0.5) * 0.1,
                        shape: Math.random() > 0.3 ? 'star' : 'dust'
                    });
                }
            }
            
            drawStar(x, y, r, color, rotation, opacity) {
                this.ctx.save();
                this.ctx.translate(x, y);
                this.ctx.rotate(rotation);
                this.ctx.beginPath();
                this.ctx.fillStyle = color;
                this.ctx.shadowBlur = 10;
                this.ctx.shadowColor = color;
                
                for (let i = 0; i < 4; i++) {
                    this.ctx.lineTo(Math.cos((0 + i * 90) * Math.PI / 180) * r, 
                                  -Math.sin((0 + i * 90) * Math.PI / 180) * r);
                    this.ctx.lineTo(Math.cos((45 + i * 90) * Math.PI / 180) * (r * 0.2), 
                                  -Math.sin((45 + i * 90) * Math.PI / 180) * (r * 0.2));
                }
                this.ctx.closePath();
                this.ctx.fill();
                this.ctx.restore();
            }

            drawDust(x, y, r, color) {
                this.ctx.beginPath();
                this.ctx.arc(x, y, r, 0, Math.PI * 2);
                this.ctx.fillStyle = color;
                this.ctx.shadowBlur = 5;
                this.ctx.shadowColor = color;
                this.ctx.fill();
            }
            
            animate() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                for (let i = 0; i < this.particles.length; i++) {
                    const p = this.particles[i];
                    p.x += p.vx;
                    p.y += p.vy;
                    p.life -= p.decay;
                    p.rotation += p.rotationSpeed;
                    
                    if (p.life > 0) {
                        this.ctx.globalAlpha = p.life;
                        if (p.shape === 'star') {
                            this.drawStar(p.x, p.y, p.size * 2, p.color, p.rotation, p.life);
                        } else {
                            this.drawDust(p.x, p.y, p.size, p.color);
                        }
                    }
                }
                this.ctx.globalAlpha = 1;
                this.particles = this.particles.filter(p => p.life > 0);
                requestAnimationFrame(() => this.animate());
            }
        }
        
        // Initialize Starry Mouse Trail
        new StarryMouseTrail();

        // Particle System (Background)
        class ParticleSystem {
            constructor() {
                this.canvas = document.getElementById('particleCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                this.resize();
                
                window.addEventListener('resize', () => this.resize());
                this.initParticles();
                this.animate();
            }

            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }

            initParticles() {
                this.particles = [];
                const count = window.innerWidth < 768 ? 50 : 150; 
                for (let i = 0; i < count; i++) {
                    this.particles.push(new Particle(this.canvas));
                }
            }

            animate() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
                this.ctx.lineWidth = 0.5;
                
                for(let i = 0; i < this.particles.length; i++) {
                    const p1 = this.particles[i];
                    p1.update();
                    p1.draw(this.ctx);
                    
                    for(let j = i + 1; j < this.particles.length; j++) {
                        const p2 = this.particles[j];
                        const dx = p1.x - p2.x;
                        const dy = p1.y - p2.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < 100) {
                            this.ctx.beginPath();
                            this.ctx.moveTo(p1.x, p1.y);
                            this.ctx.lineTo(p2.x, p2.y);
                            this.ctx.stroke();
                        }
                    }
                }
                requestAnimationFrame(() => this.animate());
            }
        }

        class Particle {
            constructor(canvas) {
                this.canvas = canvas;
                this.x = Math.random() * this.canvas.width;
                this.y = Math.random() * this.canvas.height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.size = Math.random() * 2 + 0.5;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                if (this.x < 0 || this.x > this.canvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > this.canvas.height) this.vy *= -1;
            }

            draw(ctx) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.fill();
            }
        }

        new ParticleSystem();

        // Initial Fetch
        fetchData();
    </script>
    <!-- Chat Widget -->
    <div id="chat-widget-container">
        <!-- Chat Button -->
        <button id="chat-toggle-btn" class="chat-fab">
            <i class="fas fa-robot"></i>
        </button>

        <!-- Chat Window -->
        <div id="chat-window" class="chat-window hidden">
            <div id="chat-header" class="chat-header">
                <span><i class="fas fa-robot"></i> 柒毓 (AI)</span>
                <div class="chat-controls">
                    <button id="chat-close-btn"><i class="fas fa-times"></i></button>
                </div>
            </div>
            <div id="chat-messages" class="chat-messages">
                <!-- Messages will appear here -->
                <div class="message bot-message">你好！我是柒毓。欢迎来到我的个人主页，有什么我可以帮你的吗？</div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="输入您的问题..." autocomplete="off">
                <button id="chat-send-btn"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <style>
        /* Chat Widget Styles */
        #chat-widget-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9999;
            font-family: 'Inter', sans-serif;
        }

        /* Floating Action Button */
        .chat-fab {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.6);
        }

        /* Chat Window */
        .chat-window {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 350px;
            height: 500px;
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: opacity 0.3s, transform 0.3s;
            opacity: 1;
            transform: translateY(0);
        }

        .chat-window.hidden {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
            display: none; /* Fully hide to prevent clicks */
        }

        /* Header (Draggable) */
        .chat-header {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move; /* Drag cursor */
            color: white;
            font-weight: 600;
        }

        .chat-controls button {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            font-size: 16px;
        }

        .chat-controls button:hover {
            color: white;
        }

        /* Messages Area */
        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .message {
            max-width: 80%;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 0.95rem;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .bot-message {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.1);
            color: #e5e5e5;
            border-bottom-left-radius: 2px;
        }

        .user-message {
            align-self: flex-end;
            background: #4ade80;
            color: #000;
            border-bottom-right-radius: 2px;
        }

        /* Typewriter Cursor */
        .typing-cursor::after {
            content: '|';
            animation: blink 1s step-start infinite;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        /* Input Area */
        .chat-input-area {
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 10px;
        }

        #chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 10px 15px;
            color: white;
            outline: none;
        }

        #chat-input:focus {
            border-color: #4ade80;
        }

        #chat-send-btn {
            background: none;
            border: none;
            color: #4ade80;
            font-size: 20px;
            cursor: pointer;
            padding: 0 10px;
        }

        #chat-send-btn:hover {
            color: #22c55e;
            transform: scale(1.1);
        }

        /* Mobile Responsive */
        @media (max-width: 600px) {
            .chat-window {
                width: 100%;
                height: 100%;
                bottom: 0;
                right: 0;
                border-radius: 0;
                top: 0; /* Full screen */
            }
            
            .chat-header {
                cursor: default; /* Disable drag on mobile */
            }
            
            #chat-widget-container {
                /* Reset container pos for full screen */
                bottom: 0;
                right: 0;
                left: 0;
                top: 0;
                pointer-events: none; /* Let clicks pass through when hidden */
                width: 100%;
                height: 100%;
            }
            
            #chat-toggle-btn {
                position: absolute;
                bottom: 20px;
                right: 20px;
                pointer-events: auto; /* Re-enable pointer events for FAB */
            }

            .chat-window:not(.hidden) {
                pointer-events: auto;
            }
        }
    </style>

    <script>
        // Chat Widget Logic
        const chatWidget = {
            isOpen: false,
            history: [], // Conversation history
            
            init() {
                this.cacheDOM();
                this.bindEvents();
                this.makeDraggable();
            },

            cacheDOM() {
                this.container = document.getElementById('chat-widget-container');
                this.btn = document.getElementById('chat-toggle-btn');
                this.window = document.getElementById('chat-window');
                this.closeBtn = document.getElementById('chat-close-btn');
                this.messages = document.getElementById('chat-messages');
                this.input = document.getElementById('chat-input');
                this.sendBtn = document.getElementById('chat-send-btn');
                this.header = document.getElementById('chat-header');
            },

            bindEvents() {
                this.btn.addEventListener('click', () => this.toggleChat());
                this.closeBtn.addEventListener('click', () => this.toggleChat());
                this.sendBtn.addEventListener('click', () => this.sendMessage());
                this.input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });
            },

            toggleChat() {
                this.isOpen = !this.isOpen;
                if (this.isOpen) {
                    this.window.classList.remove('hidden');
                    this.btn.style.display = 'none'; // Hide FAB when open
                    this.scrollToBottom();
                    this.logEvent('chat_opened');
                } else {
                    this.window.classList.add('hidden');
                    this.btn.style.display = 'flex';
                }
            },

            async sendMessage() {
                const text = this.input.value.trim();
                if (!text) return;

                // User Message
                this.appendMessage('user', text);
                this.input.value = '';
                this.history.push({ role: 'user', content: text });

                // Loading State
                const loadingId = this.appendLoading();

                try {
                    // Use relative URL properly - should work in most cases but let's be robust
                    const res = await fetch('/api/chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            message: text,
                            history: this.history.slice(-10) // Keep last 10 turns context
                        })
                    });
                    
                    const data = await res.json();

                    if (!res.ok) {
                        throw new Error(data.reply || data.error || `Server error: ${res.status}`);
                    }
                    
                    // Remove loading
                    this.removeMessage(loadingId);
                    
                    // Bot Message with Typewriter
                    this.typeWriter(data.reply);
                    this.history.push({ role: 'assistant', content: data.reply });
                    this.logEvent('message_sent');

                } catch (err) {
                    console.error("Chat fetch error:", err);
                    this.removeMessage(loadingId);
                    // Check if it's a connection refused error
                    let errorMsg = '抱歉，网络出了点小差错，请稍后再试。';
                    
                    // Use specific error message if available from backend (parsed above)
                    if (err.message && !err.message.includes('Failed to fetch') && !err.message.includes('NetworkError')) {
                        errorMsg = err.message;
                    } else if (err.message.includes('Failed to fetch') || err.message.includes('NetworkError')) {
                        errorMsg = '无法连接到服务器。请确保后端服务正在运行 (npm start)。';
                    }
                    this.appendMessage('bot', errorMsg);
                }
            },

            appendMessage(role, text) {
                const div = document.createElement('div');
                div.className = `message ${role}-message`;
                div.textContent = text;
                this.messages.appendChild(div);
                this.scrollToBottom();
                return div;
            },

            appendLoading() {
                const div = document.createElement('div');
                div.className = 'message bot-message';
                div.innerHTML = '<i class="fas fa-ellipsis-h fa-fade"></i>'; // FontAwesome loading
                div.id = 'msg-' + Date.now();
                this.messages.appendChild(div);
                this.scrollToBottom();
                return div.id;
            },

            removeMessage(id) {
                const el = document.getElementById(id);
                if (el) el.remove();
            },

            typeWriter(text) {
                const div = document.createElement('div');
                div.className = 'message bot-message typing-cursor';
                this.messages.appendChild(div);
                this.scrollToBottom();

                let i = 0;
                const speed = 30; // ms per char

                const type = () => {
                    if (i < text.length) {
                        div.textContent += text.charAt(i);
                        i++;
                        this.scrollToBottom();
                        setTimeout(type, speed);
                    } else {
                        div.classList.remove('typing-cursor');
                    }
                };
                type();
            },

            scrollToBottom() {
                this.messages.scrollTop = this.messages.scrollHeight;
            },

            makeDraggable() {
                // Only on desktop
                if (window.innerWidth <= 600) return;

                let isDragging = false;
                let currentX;
                let currentY;
                let initialX;
                let initialY;
                let xOffset = 0;
                let yOffset = 0;

                const dragStart = (e) => {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;

                    if (e.target === this.header || this.header.contains(e.target)) {
                        isDragging = true;
                    }
                };

                const dragEnd = () => {
                    initialX = currentX;
                    initialY = currentY;
                    isDragging = false;
                };

                const drag = (e) => {
                    if (isDragging) {
                        e.preventDefault();
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;

                        xOffset = currentX;
                        yOffset = currentY;

                        setTranslate(currentX, currentY, this.window);
                    }
                };

                const setTranslate = (xPos, yPos, el) => {
                    el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0)`;
                };

                this.header.addEventListener("mousedown", dragStart);
                document.addEventListener("mouseup", dragEnd);
                document.addEventListener("mousemove", drag);
            },
            
            logEvent(eventName) {
                // Placeholder for Analytics (A/B Testing)
                console.log(`[Analytics] Event: ${eventName}`);
                // Example: gtag('event', eventName, { ... });
            }
        };

        // Initialize when DOM loaded
        document.addEventListener('DOMContentLoaded', () => {
            chatWidget.init();
        });
    </script>
</body>
</html>